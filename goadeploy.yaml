---
- name: EOS Setup
  hosts: localhost
  vars:
    cluster_name: eos-zpn-k8s-os

  tasks:

  - name: K8s create VM
    register: fabsk8s0
    os_server:
        state: present
        auth:
          auth_url: http://10.219.106.27:35357/v3/
          username: eosadmin
          password: Abcd.1234
          project_name: eoscloud
        name: fabsk8s0
        config_drive: yes
        image: ClearLinux26430
        security_groups: Linux-Generic
        key_name: EOSKEY
        timeout: 300
        flavor: 10
        network: provider
        meta:
          hostname: fabsk8s0
          group: k8s

  - name: K8s create VM
    register: fabsk8s1
    os_server:
        state: present
        auth:
          auth_url: http://10.219.106.27:35357/v3/
          username: eosadmin
          password: Abcd.1234
          project_name: eoscloud
        name: fabsk8s1
        config_drive: yes
        image: ClearLinux26430
        security_groups: Linux-Generic
        key_name: EOSKEY
        timeout: 300
        flavor: 10
        network: provider
        meta:
          hostname: fabsk8s1
          group: k8s



- name: Register IP Addresses
  hosts: localhost
  tasks:
    - debug: 
        msg: >
           Report 
           
           
           {{ fabsk8s0.openstack.accessIPv4 }}
            
           
           
           {{ fabsk8s1.openstack.accessIPv4 }}
            
           
